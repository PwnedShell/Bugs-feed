!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(e.jQuery)}(this,function(u){!function(){"use strict";var e,t={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300,useLeftForZoom:(o=!1,(e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./))&&parseInt(e[2],10)<54&&(o=!0),o)},o=function(e){return this.core=u(e).data("lightGallery"),this.core.s=u.extend({},t,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=u(window).width()/2,this.pageY=u(window).height()/2+u(window).scrollTop()),this};o.prototype.init=function(){var i=this,e='<button type="button" aria-label="Zoom in" id="lg-zoom-in" class="lg-icon"></button><button type="button" aria-label="Zoom out" id="lg-zoom-out" class="lg-icon"></button>';i.core.s.actualSize&&(e+='<button type="button" aria-label="Actual size" id="lg-actual-size" class="lg-icon"></button>'),i.core.s.useLeftForZoom?i.core.$outer.addClass("lg-use-left-for-zoom"):i.core.$outer.addClass("lg-use-transition-for-zoom"),this.core.$outer.find(".lg-toolbar").append(e),i.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(e,t,o){var a=i.core.s.enableZoomAfter+o;u("body").hasClass("lg-from-hash")&&o?a=0:u("body").removeClass("lg-from-hash"),i.zoomabletimeout=setTimeout(function(){i.core.$slide.eq(t).addClass("lg-zoomable")},a+30)});function t(e){var t=i.core.$outer.find(".lg-current .lg-image"),o=(u(window).width()-t.prop("offsetWidth"))/2,a=(u(window).height()-t.prop("offsetHeight"))/2+u(window).scrollTop(),o=(e-1)*(i.pageX-o),a=(e-1)*(i.pageY-a);t.css("transform","scale3d("+e+", "+e+", 1)").attr("data-scale",e),(i.core.s.useLeftForZoom?t.parent().css({left:-o+"px",top:-a+"px"}):t.parent().css("transform","translate3d(-"+o+"px, -"+a+"px, 0)")).attr("data-x",o).attr("data-y",a)}function s(){1<n?i.core.$outer.addClass("lg-zoomed"):i.resetZoom(),n<1&&(n=1),t(n)}function a(e,t,o,a){var r=t.prop("offsetWidth"),t=i.core.s.dynamic?i.core.s.dynamicEl[o].width||t[0].naturalWidth||r:i.core.$items.eq(o).attr("data-width")||t[0].naturalWidth||r;i.core.$outer.hasClass("lg-zoomed")?n=1:r<t&&(n=t/r||2),a?(i.pageX=u(window).width()/2,i.pageY=u(window).height()/2+u(window).scrollTop()):(i.pageX=e.pageX||e.originalEvent.targetTouches[0].pageX,i.pageY=e.pageY||e.originalEvent.targetTouches[0].pageY),s(),setTimeout(function(){i.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)}var n=1,r=!1;i.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(e,t){var o=i.core.$slide.eq(t).find(".lg-image");o.on("dblclick",function(e){a(e,o,t)}),o.on("touchstart",function(e){r?(clearTimeout(r),r=null,a(e,o,t)):r=setTimeout(function(){r=null},300),e.preventDefault()})}),u(window).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){i.pageX=u(window).width()/2,i.pageY=u(window).height()/2+u(window).scrollTop(),t(n)}),u("#lg-zoom-out").on("click.lg",function(){i.core.$outer.find(".lg-current .lg-image").length&&(n-=i.core.s.scale,s())}),u("#lg-zoom-in").on("click.lg",function(){i.core.$outer.find(".lg-current .lg-image").length&&(n+=i.core.s.scale,s())}),u("#lg-actual-size").on("click.lg",function(e){a(e,i.core.$slide.eq(i.core.index).find(".lg-image"),i.core.index,!0)}),i.core.$el.on("onBeforeSlide.lg.tm",function(){n=1,i.resetZoom()}),i.zoomDrag(),i.zoomSwipe()},o.prototype.getCurrentTransform=function(e){if(!e)return 0;e=window.getComputedStyle(e,null),e=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")||e.getPropertyValue("transform")||"none";return"none"!==e?e.split("(")[1].split(")")[0].split(","):0},o.prototype.getCurrentRotation=function(e){if(!e)return 0;e=this.getCurrentTransform(e);return e?Math.round(Math.atan2(e[1],e[0])*(180/Math.PI)):0},o.prototype.getModifier=function(e,t,o){var a=e;e=Math.abs(e);var r=this.getCurrentTransform(o);if(!r)return 1;var i,o=1;return"X"===t?(i=Math.sign(parseFloat(r[0])),0===e||180===e?o=1:90===e&&(o=-90===a&&1===i||90===a&&-1===i?-1:1),o*=i):(i=Math.sign(parseFloat(r[3])),0===e||180===e?o=1:90===e&&(e=parseFloat(r[1]),r=parseFloat(r[2]),o=Math.sign(e*r*a*i)),o*=i),o},o.prototype.getImageSize=function(e,t,o){return 90===t&&(o="x"===o?"y":"x"),e.prop({y:"offsetHeight",x:"offsetWidth"}[o])},o.prototype.getDragCords=function(e,t){return 90===t?{x:e.pageY,y:e.pageX}:{x:e.pageX,y:e.pageY}},o.prototype.getSwipeCords=function(e,t){var o=e.originalEvent.targetTouches[0].pageX,e=e.originalEvent.targetTouches[0].pageY;return 90===t?{x:e,y:o}:{x:o,y:e}},o.prototype.getPossibleDragCords=function(e,t){var o=(this.core.$outer.find(".lg").height()-this.getImageSize(e,t,"y"))/2,a=Math.abs(this.getImageSize(e,t,"y")*Math.abs(e.attr("data-scale"))-this.core.$outer.find(".lg").height()+o),r=(this.core.$outer.find(".lg").width()-this.getImageSize(e,t,"x"))/2,e=Math.abs(this.getImageSize(e,t,"x")*Math.abs(e.attr("data-scale"))-this.core.$outer.find(".lg").width()+r);return 90===t?{minY:r,maxY:e,minX:o,maxX:a}:{minY:o,maxY:a,minX:r,maxX:e}},o.prototype.getDragAllowedAxises=function(e,t){var o=this.getImageSize(e,t,"y")*e.attr("data-scale")>this.core.$outer.find(".lg").height(),e=this.getImageSize(e,t,"x")*e.attr("data-scale")>this.core.$outer.find(".lg").width();return 90===t?{allowX:o,allowY:e}:{allowX:e,allowY:o}},o.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=u(window).width()/2,this.pageY=u(window).height()/2+u(window).scrollTop()},o.prototype.zoomSwipe=function(){var a,r=this,i={},s={},n=!1,l=!1,g=!1,d=0;r.core.$slide.on("touchstart.lg",function(e){var t;r.core.$outer.hasClass("lg-zoomed")&&(t=r.core.$slide.eq(r.core.index).find(".lg-object"),a=r.core.$slide.eq(r.core.index).find(".lg-img-rotate")[0],d=r.getCurrentRotation(a),t=r.getDragAllowedAxises(t,Math.abs(d)),g=t.allowY,((l=t.allowX)||g)&&(e.preventDefault(),i=r.getSwipeCords(e,Math.abs(d))))}),r.core.$slide.on("touchmove.lg",function(e){var t,o;r.core.$outer.hasClass("lg-zoomed")&&(o=r.core.$slide.eq(r.core.index).find(".lg-img-wrap"),e.preventDefault(),n=!0,s=r.getSwipeCords(e,Math.abs(d)),r.core.$outer.addClass("lg-zoom-dragging"),t=g?-Math.abs(o.attr("data-y"))+(s.y-i.y)*r.getModifier(d,"Y",a):-Math.abs(o.attr("data-y")),e=l?-Math.abs(o.attr("data-x"))+(s.x-i.x)*r.getModifier(d,"X",a):-Math.abs(o.attr("data-x")),(15<Math.abs(s.x-i.x)||15<Math.abs(s.y-i.y))&&(r.core.s.useLeftForZoom?o.css({left:e+"px",top:t+"px"}):o.css("transform","translate3d("+e+"px, "+t+"px, 0)")))}),r.core.$slide.on("touchend.lg",function(){r.core.$outer.hasClass("lg-zoomed")&&n&&(n=!1,r.core.$outer.removeClass("lg-zoom-dragging"),r.touchendZoom(i,s,l,g,d))})},o.prototype.zoomDrag=function(){var a,r=this,i={},s={},n=!1,l=!1,g=!1,d=!1,c=0;r.core.$slide.on("mousedown.lg.zoom",function(e){a=r.core.$slide.eq(r.core.index).find(".lg-img-rotate")[0],c=r.getCurrentRotation(a);var t=r.core.$slide.eq(r.core.index).find(".lg-object"),t=r.getDragAllowedAxises(t,Math.abs(c));d=t.allowY,g=t.allowX,r.core.$outer.hasClass("lg-zoomed")&&u(e.target).hasClass("lg-object")&&(g||d)&&(e.preventDefault(),i=r.getDragCords(e,Math.abs(c)),n=!0,r.core.$outer.scrollLeft+=1,--r.core.$outer.scrollLeft,r.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),u(window).on("mousemove.lg.zoom",function(e){var t,o;n&&(o=r.core.$slide.eq(r.core.index).find(".lg-img-wrap"),l=!0,s=r.getDragCords(e,Math.abs(c)),r.core.$outer.addClass("lg-zoom-dragging"),t=d?-Math.abs(o.attr("data-y"))+(s.y-i.y)*r.getModifier(c,"Y",a):-Math.abs(o.attr("data-y")),e=g?-Math.abs(o.attr("data-x"))+(s.x-i.x)*r.getModifier(c,"X",a):-Math.abs(o.attr("data-x")),r.core.s.useLeftForZoom?o.css({left:e+"px",top:t+"px"}):o.css("transform","translate3d("+e+"px, "+t+"px, 0)"))}),u(window).on("mouseup.lg.zoom",function(e){n&&(n=!1,r.core.$outer.removeClass("lg-zoom-dragging"),!l||i.x===s.x&&i.y===s.y||(s=r.getDragCords(e,Math.abs(c)),r.touchendZoom(i,s,g,d,c)),l=!1),r.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},o.prototype.touchendZoom=function(e,t,o,a,r){var i=this,s=i.core.$slide.eq(i.core.index).find(".lg-img-wrap"),n=i.core.$slide.eq(i.core.index).find(".lg-object"),l=i.core.$slide.eq(i.core.index).find(".lg-img-rotate")[0],g=-Math.abs(s.attr("data-x"))+(t.x-e.x)*i.getModifier(r,"X",l),l=-Math.abs(s.attr("data-y"))+(t.y-e.y)*i.getModifier(r,"Y",l),r=i.getPossibleDragCords(n,Math.abs(r));(15<Math.abs(t.x-e.x)||15<Math.abs(t.y-e.y))&&(a&&(l<=-r.maxY?l=-r.maxY:l>=-r.minY&&(l=-r.minY)),o&&(g<=-r.maxX?g=-r.maxX:g>=-r.minX&&(g=-r.minX)),a?s.attr("data-y",Math.abs(l)):l=-Math.abs(s.attr("data-y")),o?s.attr("data-x",Math.abs(g)):g=-Math.abs(s.attr("data-x")),i.core.s.useLeftForZoom?s.css({left:g+"px",top:l+"px"}):s.css("transform","translate3d("+g+"px, "+l+"px, 0)"))},o.prototype.destroy=function(){var e=this;e.core.$el.off(".lg.zoom"),u(window).off(".lg.zoom"),e.core.$slide.off(".lg.zoom"),e.core.$el.off(".lg.tm.zoom"),e.resetZoom(),clearTimeout(e.zoomabletimeout),e.zoomabletimeout=!1},u.fn.lightGallery.modules.zoom=o}()});